#summary Find graphics that looks like 'this' one
= Introduction =

This is a tool that allows the user to select a piece of graphics (a sketch, for example) before creating a CorrelationTool object.  The CorrelationTool object will search the rest of the data model for pieces of graphics that are 'similar' to that selected.

The correlation test is done both on size and shape.  It has parameters that allow the operator to adjust how similar in size and how similar in shape the various objects need to be before including them in the results set.

Finally, this CorrelationTool can be used as a source of locations for a drilling cycle operation.

I recognise that this workflow is not quite right so I suspect it will be moved into a command like 'select similar' for example.


= Details =

This module tests size by comparing the diagonal length of each bounding box.  The reference object's bounding box diagonal length is compared with each other graphics element's bounding box diagonal.  This comparison allows for both smaller and larger scaling based on a configurable parameter.

The second check is to determine shape.  The algorithm is to draw a line from the centre of each object at a configurable number of angles.  Thes lines are intersected with the object and both the number of intersections and the distance between the intersection and the centre is recorded.  Each distance is, of course, scaled based on the scaling test above.  Once this is complete, a score is assigned based both on the number of intersections at each angle and the intersection distance at each angle.  This score is averaged over the number of samples and compared with a configurable parameter.

All objects that are found to be similar enough are added to a result set of type/id pairs.

= Example Workflow =

I did this with the intent of generating the drilling cycles required to produce a printed circuit board (PCB).

 - Import a raster image of a PCB into Inkscape.

 - Use the edge detection and GCode generation routines to produce both a vector SVG file and the GCode necessary to do the 'isolation routing' operation.

 - Import the SVG file into a HeeksCNC model.

http://heekscnc.googlecode.com/svn/wiki/CorrelationTool/Wiki_CorrelationTool_pcb_following_edge_detection.png

 - Manually select one of the circles that surrounds a drill hole.

http://heekscnc.googlecode.com/svn/wiki/CorrelationTool/Wiki_CorrelationTool_with_drill_bit_made_and_pad_selected.png

 - Add a CorrelationTool object from the Operations menu.

 - Adjust both the scaling, number of samples and score values until the detected objects include only those required.

 - Select or Add a CuttingTool tool to represent the drill bit.

 - Select both the CuttingTool and CorrelationTool objects concurrently (using the 'control' button)

 - Insert a DrillingCycle operation.

http://heekscnc.googlecode.com/svn/wiki/CorrelationTool/Wiki_CorrelationTool_with_drilling_operations_found.png

 - Adjust the DrillingCycle operation's parameters such as depth etc.